<!DOCTYPE html>
<html lang="en">
<style>
  .grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 12px;
  }
  .cell {
    aspect-ratio: 1 / 1;
    background: #eaeaea;
    border-radius: 12px;
    padding: 12px;
  }
</style>
<head>
    <meta charset="UTF-8">
    <title>拾日 · 三十六格之年</title>
</head>

<body>
    <div class = "grid" id ="grid"></div>

    <div class="footer">
        点击格子 · 完成 +1
    </div>
</body>


<script>
  //定义颜色数组
  //进度对应颜色（0/10-10/10）
  const progressColors = [

  '#eaeaea', // 0
  '#e0e0e0', // 1
  '#d6d6d6', // 2
  '#cce3cc', // 3
  '#c2e0c2', // 4
  '#b8dbb8', // 5
  '#aed6ae', // 6
  '#a4d1a4', // 7
  '#9acc9a', // 8
  '#90c790', // 9
  '#2e7d32'  // 10 - 深绿

  ]

    // 最简单的起步：先手动渲染6个格子，看看样式对不对
  const grid = document.getElementById('grid');
    // 先清空
  grid.innerHTML = '';

  //读取存储的进度

  let cellsData = []

  const saved = localStorage.getItem('shiri_cells');

  if (saved) {
      cellsData = JSON.parse(saved);//数组，长度36

  }
  else{
    //如果没有存储过，初始值为0
      cellsData = new Array(36).fill(0).map((_, index) =>({
          progress: 0,
          name: `第${index+1}格`//默认名字
      }))

  }
    // 生成36个格子，数据写死

  for (let i = 0; i < 36; i++) {
    const cell = document.createElement('div');
    const cellData = cellsData[i]
    cell.className = 'cell';
    cell.setAttribute('data-index',i);
    //根据当前进度设置背景色
    cell.style.backgroundColor = progressColors[cellData.progress];
    //格子内部结构
    cell.innerHTML = `
     <div style="display: flex;justify-content: space-between;font-size: 0.75rem;">
      <span>${i+1}/36</span>
      <span class="cell-progress">${cellData.progress}/10</span>
     </div>
     <div style = "margin-top: 8px;font-size: 0.9rem;font-weight: 500;text-align: center;"class = "cell-name">
     ${cellData.name}
     </div>
    `;
    //======单击事件：进度+1，颜色变化

    cell.onclick = function() {
        //alert('格子被点了！');
        let index = parseInt(this.getAttribute('data-index'));

        if (cellsData[index].progress < 10 ){
            cellsData[index].progress ++;
            // 更新进度文字
            this.querySelector('.cell-progress').innerHTML = cellsData[index].progress + '/10';

            //更新界面格子背景色
            this.style.backgroundColor =progressColors[cellsData[index].progress];

             //存储
            localStorage.setItem('shiri_cells', JSON.stringify(cellsData));
        }
    };

    //====双击事件：修改名字====
      cell.ondblclick = function(e) {
          //阻止事件冒泡
          e.stopPropagation();

          let index = parseInt(this.getAttribute('data-index'));
          let newName = prompt('给这十天起个名字叭~',cellsData[index].name);

          if (newName && newName.trim() !== '') {
                    // 更新数据
                    cellsData[index].name = newName.trim();
                    // 更新显示
                    this.querySelector('.cell-name').innerText = newName.trim();
                    // 保存
                    localStorage.setItem('shiri_cells', JSON.stringify(cellsData));
                }
      };

    grid.appendChild(cell);
  }
</script>
</html>